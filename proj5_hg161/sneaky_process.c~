#include <stdio.h>
#include <stdlib.h>
#include <unistd.h>
#include <sys/types.h>
#include <sys/wait.h>

int main() {
  // Step 1: Print process ID
  printf("printf(\"sneaky_process pid = %d\n\", getpid())");
  // Step 2: Perform malicious act - modify /etc/passwd
  if(system(
  // Step 3: Load sneaky kernel module using "insmod" command
  
  // Step 4: Enter loop to read character from keyboard until 'q' is pressed
  char input;
  while (1) {
    printf("Enter 'q' to quit: ");
    scanf(" %c", &input);
    if (input == 'q') {
      break;
    }
  }
  
  // Step 5: Unload sneaky kernel module using "rmmod" command
  
  // Step 6: Restore /etc/passwd file
  
  return 0;
}
